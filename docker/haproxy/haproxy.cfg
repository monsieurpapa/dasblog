# /home/ubuntu/accounting_project/docker/haproxy/haproxy.cfg

global
    log stdout format raw local0 info
    maxconn 4096

defaults
    log global
    mode http
    option httplog
    option dontlognull
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

frontend http_frontend
    bind *:8080 # Internal port Nginx will forward to
    default_backend django_backend

backend django_backend
    balance roundrobin
    # Add more app servers if scaling horizontally
    # Ensure the service name 'app' matches docker-compose.yml
    server app1 app:8000 check
    # server app2 app:8000 check # Example for scaling

# Optional: Add stats page
# listen stats
#     bind *:8404
#     stats enable
#     stats uri /
#     stats refresh 10s
#     stats admin if TRUE # Be careful with enabling admin in production

